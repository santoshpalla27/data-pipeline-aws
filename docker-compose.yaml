services:
  pricing-downloader:
    build:
      context: ./aws-pricing-downloader
      dockerfile: Dockerfile
    image: aws-pricing-downloader:2.0.0
    container_name: aws-pricing-downloader

    # Mount to /app/data/aws_pricing (where config writes by default)
    volumes:
      - ./data/aws_pricing:/app/data/aws_pricing:rw
      - ./metrics:/app/metrics:rw
      - ./services.txt:/app/services.txt:ro

    environment:
      - PYTHONUNBUFFERED=1
      - LOG_LEVEL=INFO

    # Remove --output-dir and --metrics-dir (use defaults)
    command: >
      download --no-verify --services  AmazonEC2 AmazonOpenSearchService ACM AmazonApiGateway AmazonCloudFront AmazonCloudWatch AWSCloudTrail AmazonDynamoDB AmazonECR AmazonECRPublic AmazonECS AmazonEFS AmazonEKS AmazonElastiCache AmazonMQ AmazonMSK AmazonRDS AmazonRoute53 AmazonS3 AmazonS3GlacierDeepArchive AmazonSNS AmazonStates AmazonVPC AWSCloudFormation AWSCodeArtifact CodeBuild AWSCodeCommit AWSCodeDeploy AWSCodePipeline AWSConfig AWSELB AWSElasticDisasterRecovery AWSEvents awskms AWSLambda AWSQueueService AWSSecretsManager AWSServiceCatalog AWSShield AWSSystemsManager AWSXRay awswaf AmazonSES AmazonPinpoint AmazonKinesis AmazonFSx AWSBackup AWSDataTransfer AmazonFSx AWSBackup AWSDataTransfer AWSGlobalAccelerator AWSFMS

    restart: "no"

    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
